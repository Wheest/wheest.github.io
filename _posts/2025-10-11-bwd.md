---
layout: post
title: "Show Me Your Code: Binary White Dwarfs"
date: 2025-10-11 12:20:08 +0200
categories: blog
tags: python science physics
excerpt_separator: <!--more-->
---

<script>
(function() {
  const pronouns = [
    { subject: "she", object: "her", possessive: "her" },
    { subject: "he",  object: "him", possessive: "his" },
    { subject: "they", object: "them", possessive: "their" },
  ];

  // Randomly pick one pronoun set for this page load
  const choice = pronouns[Math.floor(Math.random() * pronouns.length)];

  // Update all spans with the appropriate form
  document.querySelectorAll(".pronoun").forEach(el => {
    const type = el.dataset.type || "subject";
    el.textContent = choice[type] || choice.subject;
  });
})();
</script>

> Under construction

I've recently been chatting with [Melize Ferrus](https://orcid.org/0000-0002-2842-2067), currently working on <span class="pronoun" data-type="possessive"></span> PhD in
astrophysics, studying the dynamics of black hole mergers.

It's not an area I have much expertise in, but through a series of chats, and
playing around with some of <span class="pronoun" data-type="possessive"></span> code (making some fun
demos), I thought I'd discuss what I've learned.
This is not a deep dive into the physics, but rather an exercise in
cross-discipline communication, and a chance to play with some Python code.

<!--more-->

I've asked Melize to write some clarifications and corrections, which will
appear in block quotes like this.

> Hi there, I'm Melize

The rest of the text is my understanding, and may contain errors. Anything you
see that is wrong is my fault, not Melize's. Everything should be prefixed with
"I reckon". You can read more about Melize's work on gravitational waves in
[this
article](https://nautil.us/a-supermassive-test-for-einsteins-famous-theory-312691/).

Melize's code is closed source for now while <span class="pronoun"
data-type="subject"></span> work on some active areas of research, but I was
given access to it for this exercise.
The [`astropy`](https://www.astropy.org/) and [`numpy`](https://numpy.org/)
libraries are used extensively.

# The Problem Area

The code that Melize has been working with is looking at binary
white dwarf (BWD) systems. These are pairs of white dwarf stars (which are the cores
of dead stars, around the mass of our sun) orbiting each other.

There are a few reasons why these systems are interesting to study. From what I
gather though, under particular interest is that when these stars get close to
each other, they can produce very small gravitational waves.

> Melize here:

It is difficult to detect gravitational waves from such small systems, but the
reason why we care is that they contribute noise, or "background radiation", to
the gravitational wave signals we care about, such as those from black hole mergers.

Therefore, understanding these white dwarf systems helps us to better interpret
the gravitational wave data we receive from detectors like LIGO and Virgo.

> Melize again:

# The Code

I saw that Melize's code had two main parts, both of which using "Gibbs
Sampling".
Gibbs sampling is a statistical technique used to generate samples from a
probability distribution.

> Melize, what is Gibbs sampling?

The two main parts were:

- Drawing samples of what the binary white dwarf systems might look like
  (e.g. their masses, distances, and orbital periods).
- Generating _where_ in the galaxy these systems might be located.

Boffins have modelled what we think the distribution of these systems looks like, and
what this code is doing is drawing samples from this distribution.
The specifics of the distributions are not important for this discussion, and
not something I've taken the time to understand.

> Melize, can you explain the distributions?

# Binary White Dwarf Systems

When we generate a sample of a binary white dwarf system, we are generating:

- The mass of the first white dwarf (in solar masses).
- The mass of the second white dwarf (in solar masses).
- Their orbital separation (in solar radii).
- Their orbital eccentricity (what shape their orbit is).

For example, a sample I generated from Melize's code was:

**Example Binary White Dwarf System**

<!-- prettier-ignore-start -->
$$
\begin{aligned}
m_1 &= 1.33\,M_\odot \\
m_2 &= 0.64\,M_\odot \\
e   &= 0.38 \\
a   &= 7.26 \times 10^5\,R_\odot
\end{aligned}
$$
<!-- prettier-ignore-end -->

To help with my own exploration, I also gave each system a random name, using 2 words from the [EFF Long
Wordlist](https://www.eff.org/dice).

E.g.,

```
overrun-nicotine
stack-thursday
goldmine-undesired
strained-hurried
ecologist-undead
cherisher-degree
supermom-unsigned
rescuer-sternum
zebra-crepe
```

From this code, we can generate as many samples as we want, and our set of
binary white dwarf systems will be distributed according to our model.

> Melize, what can we do with these samples?

# Galactic Coordinates

We expect the white dwarf systems to be distributed around the Milky Way galaxy,
with a higher density towards the center of the galaxy, and a lower density as
we move away from the center.

The galaxy is modelled as a disk, with a bulge in the center. The model that
Melize uses "cylindrical galactic coordinates", which are:

- \(R\): Galactocentric radial distance: the distance from the center of the
  galaxy.
- \(Z\): the vertical distance above or below the galactic midplane.

This is in contrast to the more familiar cartesian coordinates `(x, y, z)`.
However, to convert from galactic coordinates to cartesian coordinates, we also
need the "azimuthal" angle $\phi$, which is the angle around the center of the
galaxy. This requires an assumption about how the systems are distributed _around_ the galaxy.
This isn't necessary for Melize's work, but I wanted to visualise the results in
a format I was more familiar with.

Therefore I added a third step to the code, which was to draw a random angle
between `[0, τ]`, and then convert from galactic coordinates to cartesian ones.
We already have the `Z` coordinate, and we can convert from `(R, φ)` to `(x, y)`
using:

<!-- prettier-ignore-start -->
$$
\begin{aligned}
x &= R \cos(\phi) \\
y &= R \sin(\phi)
\end{aligned}
$$
<!-- prettier-ignore-end -->

> Melize, thoughts on this:?

# Visualisation

Now, with Melize's code, and some minor data transformation, we can now generate
5,000 BWD systems, and also generate their positions in the galaxy. The code is
capable of generating as many samples as we want, but for my purposes I kept the
number small.

This plot is interactive, using the `plotly` library, and its `go.Scatter3d`
tool.
I initially made this in a Jupyter notebook, but then converted it to a exported
it to a format that run in the browser, using
`fig.write_json("2025-10-binaries.json")`.

```python
# Create an interactive 3D scatter plot of the sampled systems
fig = go.Figure(
    go.Scatter3d(
        x=x,
        y=y,
        z=z_vals,
        mode="markers",
        text=hover_text,
        hoverinfo="text",
        marker=dict(
            size=3,
            color=m1_vals,
            colorscale="Turbo",
            colorbar=dict(title="Primary Mass [M☉]", tickcolor="white"),
            opacity=0.8,
        ),
    )
)
```

If you hover over a point, it will show you the details of that binary white
dwarf system, including the randomly generated name I added.

You can see it below, if your browser supports it.

<div id="binaries_plot" style="width:100%;height:600px;"></div>

# Audio Shenanigans

`TODO`

# Q&A

Now that I've shown some of my hacking around with Melize's code, here I take
the opportunity to ask _<span class="pronoun" data-type="objective"></span>_ some
questions.

What got you interested in this area of research?

> Melize here:

What are some big open questions in this area of research?

> Melize here:

You deal with some pretty large simulations and computations.
Would you say that programming is a big part of your work?
Is there enough collaboration between physicists and computer experts?

> Melize here:

You're black, and present pretty femme, which is still pretty rare in physics.
Have you had any interesting or noteworthy experiences through this lens?

> Melize here:

What are the biggest uncertainties in the models you work with?

> Melize here:

# Conclusions

When I talk to specialists in other fields, when they are articulate and
passionate about their work, I find it infectious.
I usually come away with the feeling of "ah, so it _isn't magic_, but _it is_ hard".
I haven't eaten my intellectual vegetables here of doing the exercises of
general relativity textbooks, but by inhabiting Melize's code for a while, and
picking <span class="pronoun" data-type="possessive"></span> brain, I feel like I've gained a little more
appreciation of the field.

<script src="https://cdn.plot.ly/plotly-2.35.2.min.js"></script>
<div id="binaries_plot" style="width:100%;height:600px;"></div>
<script>
fetch('/assets/plotly/2025-10-binaries.json')
  .then(r => r.json())
  .then(fig => Plotly.newPlot('binaries_plot', fig.data, fig.layout, {responsive:true}));
</script>
